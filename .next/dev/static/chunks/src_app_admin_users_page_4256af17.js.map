{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/weather-dashboard/src/app/admin/users/page.js"],"sourcesContent":["\"use client\";\r\nimport Image from 'next/image';\r\nimport { useEffect, useState, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport { Trash2, Search, User, Ban, CheckCircle } from 'lucide-react'; \r\n\r\nexport default function ManageUsers() {\r\n  const [users, setUsers] = useState([]);\r\n  const [search, setSearch] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchUsers = useCallback(async () => {\r\n     try {\r\n         const res = await axios.get('/api/admin/users');\r\n         setUsers(res.data);\r\n         setLoading(false);\r\n     } catch (e) {\r\n         console.error(e);\r\n     }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const t = setTimeout(() => fetchUsers(), 0);\r\n    return () => clearTimeout(t);\r\n  }, [fetchUsers]);\r\n\r\n  const handleToggleBan = async (user) => {\r\n      const action = user.isBanned ? 'activate' : 'ban';\r\n      if(!confirm(`Are you sure you want to ${action} this user?`)) return;\r\n      try {\r\n          const res = await axios.put('/api/admin/users', { id: user._id, isBanned: !user.isBanned });\r\n          setUsers(users.map(u => u._id === user._id ? res.data.user : u));\r\n      } catch (e) {\r\n          alert(`Failed to ${action} user`);\r\n      }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n      if(!confirm(\"Are you sure you want to delete this user?\")) return;\r\n      try {\r\n          await axios.delete(`/api/admin/users?id=${id}`);\r\n          setUsers(users.filter(u => u._id !== id));\r\n      } catch (e) {\r\n          alert(\"Failed to delete user\");\r\n      }\r\n  };\r\n\r\n  const filteredUsers = users.filter(u => \r\n      u.name.toLowerCase().includes(search.toLowerCase()) || \r\n      u.email.toLowerCase().includes(search.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div className=\"p-8\">\r\n        <h2 className=\"text-3xl font-bold text-slate-800 mb-6\">User Management</h2>\r\n        \r\n        <div className=\"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden\">\r\n            <div className=\"p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50\">\r\n                <div className=\"relative\">\r\n                    <Search className=\"absolute left-3 top-2.5 text-slate-400\" size={18}/>\r\n                    <input \r\n                      type=\"text\" \r\n                      placeholder=\"Search users...\" \r\n                      className=\"pl-10 pr-4 py-2 bg-white border border-slate-200 rounded-xl text-sm outline-none focus:border-blue-500\"\r\n                      value={search}\r\n                      onChange={e => setSearch(e.target.value)}\r\n                    />\r\n                </div>\r\n                <div className=\"text-sm text-slate-500\">\r\n                    Total: <span className=\"font-bold text-slate-800\">{users.length}</span>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full text-left text-sm text-slate-600\">\r\n                    <thead className=\"bg-slate-50 text-xs uppercase font-bold text-slate-400\">\r\n                        <tr>\r\n                            <th className=\"p-4\">User</th>\r\n                            <th className=\"p-4\">Email</th>\r\n                            <th className=\"p-4\">Role</th>\r\n                            <th className=\"p-4\">Joined</th>\r\n                            <th className=\"p-4 text-right\">Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-slate-100\">\r\n                        {filteredUsers.map(user => (\r\n                            <tr key={user._id} className=\"hover:bg-slate-50/80 transition\">\r\n                                <td className=\"p-4 flex items-center gap-3\">\r\n                                    <div className=\"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-xs overflow-hidden relative\">\r\n                                        {user.profilePicture ? <Image src={user.profilePicture} alt=\"pic\" fill className=\"object-cover\" unoptimized /> : <User size={14}/>}\r\n                                    </div>\r\n                                    <span className=\"font-medium text-slate-800\">{user.name}</span>\r\n                                </td>\r\n                                <td className=\"p-4\">{user.email}</td>\r\n                                <td className=\"p-4\">\r\n                                    <span className={`px-2 py-1 rounded text-xs font-bold ${user.role === 'admin' ? 'bg-purple-100 text-purple-600' : 'bg-green-100 text-green-600'}`}>\r\n                                        {user.role}\r\n                                    </span>\r\n                                    {user.isBanned && <span className=\"ml-2 bg-red-100 text-red-600 px-2 py-1 rounded text-xs font-bold\">BANNED</span>}\r\n                                </td>\r\n                                <td className=\"p-4 text-slate-400\">{new Date(user.createdAt).toLocaleDateString()}</td>\r\n                                <td className=\"p-4 text-right flex justify-end gap-2\">\r\n                                    {user.role !== 'admin' && (\r\n                                        <>\r\n                                            <button \r\n                                                onClick={() => handleToggleBan(user)}\r\n                                                className={`p-2 rounded-lg transition ${user.isBanned ? 'text-green-500 hover:bg-green-50' : 'text-orange-500 hover:bg-orange-50'}`}\r\n                                                title={user.isBanned ? \"Activate User\" : \"Ban User\"}\r\n                                            >\r\n                                                {user.isBanned ? <CheckCircle size={16} /> : <Ban size={16} />}\r\n                                            </button>\r\n                                            <button \r\n                                            onClick={() => handleDelete(user._id)}\r\n                                            className=\"text-red-400 hover:bg-red-50 p-2 rounded-lg transition\"\r\n                                            title=\"Delete User\"\r\n                                            >\r\n                                                <Trash2 size={16} />\r\n                                            </button>\r\n                                        </>\r\n                                    )}\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n                {filteredUsers.length === 0 && (\r\n                    <div className=\"p-8 text-center text-slate-400\">No users found</div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}